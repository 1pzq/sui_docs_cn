# Sui 的 Gas 费

Sui 燃气定价机制实现了三个目标：提供低廉、可预测的交易费用，激励验证器优化其交易处理操作，并防止拒绝服务攻击。

这使你能够专注于使用 Sui 网络提供最佳用户体验，而无需预测当前燃气费用的市场价格。由于验证器在每个纪元开始时就网络范围的参考价格达成一致，你可以在提交交易时使用参考价格作为可信的锚点。此外，价格设置机制奖励良好的验证器行为，从而使 SUI 代币持有者、网络运营商（验证器）和用户之间的激励保持一致。

Sui 燃气价格机制的一个独特特征是用户支付执行交易和存储与每个交易相关的数据的独立费用。与任意交易 $\tau$ 相关的燃气费用如下：

$$
GasFees[\tau] \ = \ ComputationUnits[\tau] \times ComputationPrice[\tau] \ + \ StorageUnits[\tau] \times StoragePrice
$$

燃气函数 $ComputationUnits[\tau]$ 和 $StorageUnits[\tau]$ 分别测量处理和存储与 $\tau$ 相关的数据所需的计算和存储资源的数量。燃气价格 $ComputationPrice[\tau]$ 和 $StoragePrice$ 将计算和存储的成本转化为 SUI 单位。燃气单位和燃气价格之间的解耦是有用的，因为 SUI 的市场价格会根据供需关系随时间波动。

## 计算燃气价格 {#computation}

计算燃气价格 $ComputationPrice[\tau]$ 捕捉在 SUI 单位中计算的一单位成本。该价格在交易级别设置，并由用户作为交易的燃气价格提交。在概念上，有必要将这个燃气价格分为两个部分来考虑：

$$
ComputationPrice[\tau] \ = \ ReferencePrice \ + \ Tip[\tau]
$$

在 Sui 网络上，每个纪元都存在一个 $ReferencePrice$，Sui 验证器在每个纪元边界更新 $ReferencePrice$。因此，在实践中，当用户提交高于 $ReferencePrice$ 的燃气价格时，有必要将其差异视为支付给网络的小费，以获取更高的优先级。在常规网络操作时，预计用户无需支付小费，绝大多数交易的燃气价格等于 $ReferencePrice$。

更一般地说，Sui 燃气价格机制使 $ReferencePrice$ 成为你在提交交易到网络时的可信锚点。合理确信以接近或等于参考价格的燃气价格提交的交易将及时执行。这是通过以下三个核心步骤实现的：

- **燃气价格调查：** 在每个纪元开始时，对所有验证器进行调查，每个验证器都提交其保留价格。也就是说，每个验证器陈述他们愿意处理交易的最低燃气价格。协议对这些报价进行排序，并选择按权益排名的 2/3 百分位数作为参考价格。燃气价格调查的目标是设置一个大多数验证器愿意迅速处理交易的参考价格。
- **计分规则：** 在整个纪元中，验证器获取关于其他验证器操作的信号。每个验证器使用这些信号来建立对每个其他验证器表现的（主观的）评估。具体而言，每个验证器为其他每个验证器的权益奖励构建一个乘数，以便表现良好的验证器获得提高的奖励，而表现不佳的验证器获得降低的奖励。计分规则的目标是创建一种社区强制的机制，鼓励验证器遵守参考燃气价格。
- **激励的权益奖励分配规则：** 在纪元结束时，使用来自计分规则的信息调整验证器之间的权益奖励分配。具体而言，使用在计分规则期间构建的个体乘数集合的中位数值（按权益加权）为每个验证器构建一个全局乘数。其他条件相同，以参考燃气价格运作的良好的验证器获得其常规权益奖励，而未能以参考燃气价格运作的验证器则获得削减的奖励。由于权益奖励受到每个验证器拥有的权益数量的影响，验证器受到鼓励通过降低燃气费用和淘汰效率低下的验证器来获得更多的权益。这有利于 Sui 最终用户，因为权益奖励分配规则激励验证器提供更具成本效益的网络。

总的来说，燃气价格机制有两个主要力量：计分规则激励验证器遵守燃气调查期间提交的报价，而分配规则激励验证器提交低的保留价格。这两种力量的相互作用提供了一种机制，鼓励验证器设定较低的网络级参考燃气价格 - 但不要太低，因为如果他们无法遵守报价，他们将面临处罚。换句话说，燃气价格机制鼓励公平价格的健康竞争。

# 存储燃气价格 {#storage}

存储燃气价格 $StoragePrice$ 捕捉了以 SUI 单位永久覆盖一单位存储的成本。这个价格是通过治理提案设定的，并且更新不频繁。其目标是确保 Sui 用户支付他们在链上数据存储的费用，通过将这些费用存入存储基金，然后将这些费用重新分配给未来的验证器。与计算燃气价格相比，存储价格在纪元内和跨纪元的所有交易中都是固定的，直到存储价格更新。

$StoragePrice$ 是通过治理提案外生设定的，其目标是针对链下数据存储的美元成本。从长远来看，随着存储成本由于技术进步而降低以及 SUI 代币的美元价格演变，治理提案将更新价格以反映新的美元目标价格。

## 燃气价格作为协调机制 {#coordination-mechanism}

总的来说，当你提交具有计算燃气价格接近或等于当前纪元 $ReferencePrice$ 以及存储燃气价格接近或等于目标 $StoragePrice$ 的交易时，你将获得最佳用户体验。Sui 燃气价格机制为你提供了可信的提交交易的参考价格。通过激励验证器引出其真实的保留价格并遵守这些报价，你可以可靠地假设你的交易会及时处理。

在 Sui 启用横向扩展之后，验证器可以根据链上活动需求的扩展增加更多的工作人员。这使得他们的成本与网络活动的速度相同线性增加，并使他们能够以相同的低燃气价格处理更多的交易。在网络拥塞极端的情况下，验证器无法快速扩展时，小费的存在提供了一种基于市场的拥塞定价机制，通过提高在 Sui 平台上进行交易的成本来抑制进一步的需求激增。

从长远来看，Sui 燃气价格机制为验证器优化其硬件和操作创造了激励。投资于提高效率的验证器能够遵守较低的燃气价格并获得权益奖励提升。因此，Sui 验证器受到鼓励进行创新并提升最终用户的体验。
